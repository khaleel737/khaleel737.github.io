<!doctype html><html lang=en><head><script defer src=https://analytics.eu.umami.is/script.js data-website-id=ff740bb2-f741-4bc5-975e-49691d82ef39></script><meta charset=utf-8><meta name=generator content="Hugo 0.147.2"><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><meta name=author content><meta property="og:url" content="https://maxhalford.github.io/blog/hard-data-integration-problems-at-carbonfact/"><link rel=canonical href=https://maxhalford.github.io/blog/hard-data-integration-problems-at-carbonfact/><meta property="og:url" content="https://maxhalford.github.io/blog/hard-data-integration-problems-at-carbonfact/"><meta property="og:site_name" content="Max Halford"><meta property="og:title" content="Hard data integration problems at Carbonfact"><meta property="og:description" content="Carbonfactâ€™s customers are clothing brands and factories. Our mission is to measure (and ultimately reduce) the carbon footprint of their products. We need primary data to do this: purchase orders, bills of materials, energy consumption data, etc.
Each customer has a unique IT setup, which makes it challenging to scale to hundreds/thousands of customers. Our success as a business depends on our ability to not reinvent the wheel for each customer."><meta property="og:locale" content="en_us"><meta property="og:type" content="article"><meta property="article:section" content="blog"><meta property="article:published_time" content="2025-01-02T00:00:00+00:00"><meta property="article:modified_time" content="2025-01-02T00:00:00+00:00"><meta property="article:tag" content="Data-Science"><meta property="og:image" content="https://maxhalford.github.io/img/belle-ile.jpg"><meta name=twitter:card content="summary_large_image"><meta name=twitter:image content="https://maxhalford.github.io/img/belle-ile.jpg"><meta name=twitter:title content="Hard data integration problems at Carbonfact"><meta name=twitter:description content="Carbonfactâ€™s customers are clothing brands and factories. Our mission is to measure (and ultimately reduce) the carbon footprint of their products. We need primary data to do this: purchase orders, bills of materials, energy consumption data, etc.
Each customer has a unique IT setup, which makes it challenging to scale to hundreds/thousands of customers. Our success as a business depends on our ability to not reinvent the wheel for each customer."><link rel=icon href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>ðŸ¦†</text></svg>"><script type=application/ld+json>{"@context":"http://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/maxhalford.github.io\/"},"articleSection":"blog","name":"Hard data integration problems at Carbonfact","headline":"Hard data integration problems at Carbonfact","description":"\u003cp\u003eCarbonfact\u0026rsquo;s customers are clothing brands and factories. Our mission is to measure (and ultimately reduce) the carbon footprint of their products. We need primary data to do this: purchase orders, bills of materials, energy consumption data, etc.\u003c\/p\u003e\n\u003cp\u003eEach customer has a unique IT setup, which makes it challenging to scale to hundreds\/thousands of customers. Our success as a business depends on our ability to not reinvent the wheel for each customer.\u003c\/p\u003e","inLanguage":"en-US","author":"","creator":"","publisher":"","accountablePerson":"","copyrightHolder":"","copyrightYear":"2025","datePublished":"2025-01-02 00:00:00 \u002b0000 UTC","dateModified":"2025-01-02 00:00:00 \u002b0000 UTC","url":"https:\/\/maxhalford.github.io\/blog\/hard-data-integration-problems-at-carbonfact\/","keywords":["data-science"]}</script><title>Hard data integration problems at Carbonfact â€¢ Max Halford</title>
<meta property="og:title" content="Hard data integration problems at Carbonfact â€¢ Max Halford"><meta property="og:type" content="article"><meta name=description content="Carbonfact&rsquo;s customers are clothing brands and factories. Our mission is to measure (and ultimately reduce) the carbon footprint of their products. We need primary data to do this: purchase orders, bills of materials, energy consumption data, etc.
Each customer has a unique IT setup, which makes it challenging to scale to hundreds/thousands of customers. Our success as a business depends on our ability to not reinvent the wheel for each customer."><link rel=stylesheet href=/css/flexboxgrid-6.3.1.min.css><link rel=stylesheet href=/css/github-markdown.min.css><link rel=stylesheet href=/css/highlight/github.css><link rel=stylesheet href=/css/index.css><link rel=preconnect href=https://fonts.gstatic.com><link href="https://fonts.googleapis.com/css2?family=PT+Serif:wght@400;700&family=Permanent+Marker&display=swap" rel=stylesheet><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]],displayMath:[["$$","$$"],["\\[","\\]"]],processEscapes:!0,processEnvironments:!0,tags:"ams"},options:{skipHtmlTags:["script","noscript","style","textarea","pre"]}},window.addEventListener("load",e=>{document.querySelectorAll("mjx-container").forEach(function(e){e.parentElement.classList+="has-jax"})})</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script></head><body><article class=post id=article><div class="row center-xs" style=text-align:left><div class="col-xs-12 col-sm-10 col-md-7 col-lg-5"><div class=header><header class=header-parts><div class="signatures site-title"><a href=/>Max Halford ãƒ„</a></div><div class=header-links><a class=header-link href=/>Blog</a>
<a class=header-link href=/links/>Links</a>
<a class=header-link href=/bio/>Bio</a>
<a class=header-link href=/uses/>Uses</a></div></header></div><header class=post-header><h1 class=post-title>Hard data integration problems at Carbonfact</h1><div class="row post-desc"><div class="col-xs-12 post-desc-items"><time class=posts-line-date datetime="2025-01-02 00:00:00 UTC">2025-01-02
</time><span class=posts-line-tag>data-science</span></div></div></header><div class="post-content markdown-body"><h2 id=toc>Table of contents</h2><nav id=TableOfContents><ul><li><a href=#mutable-systems-lead-to-misrepresentations>Mutable systems lead to misrepresentations</a></li><li><a href=#multisourced-supply-chains-dont-surface-to-the-top>Multisourced supply chains don&rsquo;t surface to the top</a></li><li><a href=#it-migrations-arent-retroactive>IT migrations aren&rsquo;t retroactive</a></li><li><a href=#information-isnt-correct-and-nobody-has-ownership>Information isn&rsquo;t correct, and nobody has ownership</a></li></ul></nav><p>Carbonfact&rsquo;s customers are clothing brands and factories. Our mission is to measure (and ultimately reduce) the carbon footprint of their products. We need primary data to do this: purchase orders, bills of materials, energy consumption data, etc.</p><p>Each customer has a unique IT setup, which makes it challenging to scale to hundreds/thousands of customers. Our success as a business depends on our ability to not reinvent the wheel for each customer.</p><p>Data integration is a difficult problem to work on. In fact, in my experience, it&rsquo;s one of the hardest data science tasks. This is because many aspects can&rsquo;t just be addressed with technical solutions. LLMs and machine learning are useful, but they don&rsquo;t change the fact customers have all kinds of messed up edge-cases on their end.</p><blockquote><p><em>Customer data is like a box of chocolates: you never know what you&rsquo;re going to get.</em></p></blockquote><blockquote><p><em>Sturgeon&rsquo;s law: 90% of everything is crap.</em></p></blockquote><p>I&rsquo;m not yet convinced the kind of data integration we do at Carbonfact can be fully automated. We take a white gloved approach: we look at the customer&rsquo;s data with our eyes, we meet with them, we ask questions, and we write a bespoke connector. Our customers are delighted. But don&rsquo;t get fooled: we&rsquo;re not consultants, and our objective is to automate and scale our methodology. It&rsquo;s just really hard.</p><p>The purpose of this blog post is to list some tough data integration topics we are seeing repeatidly at Carbonfact. This list should give proof that the &ldquo;AI will replace data scientists&rdquo; narrative is poppycock. I also want to use this post to give my team and our customers some food for thought.</p><p>I haven&rsquo;t listed everything: <em>le secret d&rsquo;ennuyer est celui de tout dire.</em> There are mundane topics which we deal on a daily basis: normalizing human inputs, imputing missing data, etc. I gave an example of dealing with manually entered product compositions in a <a href=/blog/carbonfact-nlp-open-problem/>previous blog post</a>. Instead, here I&rsquo;ve focused on hard stuff for which I do not see an obvious technical solution.</p><h2 id=mutable-systems-lead-to-misrepresentations>Mutable systems lead to misrepresentations</h2><p>Clothing brands use <a href=https://en.wikipedia.org/wiki/Product_lifecycle>PLMs</a> and <a href=https://en.wikipedia.org/wiki/Product_information_management>PIMs</a> to keep track of their products. For instance, these systems are the source of truth for the <a href=https://en.wikipedia.org/wiki/Bill_of_materials>bill of materials</a>.</p><p>Staple products that are sold year-on-year are called carry-over products. The bill of materials for these products may change over time. For instance, the company might decide to switch from 100% cotton to 100% organic cotton.</p><p>In a good setup, each bill of materials is versioned. Typically, a single SKU is associated with one version for each season where it is sold:</p><table><thead><tr><th>sku</th><th>season</th><th>composition</th></tr></thead><tbody><tr><td>123</td><td>Summer 2023</td><td>100% cotton</td></tr><tr><td>123</td><td>Summer 2024</td><td>100% cotton</td></tr><tr><td>123</td><td>Summer 2025</td><td>100% organic cotton</td></tr></tbody></table><p>This allows indicating which particular variant of each SKU was ordered in the <a href=https://en.wikipedia.org/wiki/Enterprise_resource_planning>ERP</a>:</p><table><thead><tr><th>sku</th><th>season</th><th>date</th><th>units</th></tr></thead><tbody><tr><td>123</td><td>Summer 2023</td><td>2022-03-01</td><td>1200</td></tr><tr><td>123</td><td>Summer 2023</td><td>2022-04-01</td><td>800</td></tr><tr><td>123</td><td>Summer 2024</td><td>2023-03-01</td><td>1800</td></tr><tr><td>123</td><td>Summer 2024</td><td>2023-04-01</td><td>1400</td></tr><tr><td>123</td><td>Summer 2025</td><td>2024-05-01</td><td>4000</td></tr></tbody></table><p>The problem is that not all systems are well-behaved and version their data. Take the PLM: if it isn&rsquo;t versioned, then changing 100% cotton to 100% organic cotton will change the composition for future purchase orders, but also old ones! And even if the PLM is versioned, the ERP might not be. This happens a lot in practice, because different teams/vendors/consultants are responsible for each system.</p><p>One solution is that we could version customers files ourselves. But that would only apply starting from the moment we get access to the customer&rsquo;s data, and it would not be retroactive. Furthermore, it would imply us having to deal with evolving file formats, which is a nightmare.</p><h2 id=multisourced-supply-chains-dont-surface-to-the-top>Multisourced supply chains don&rsquo;t surface to the top</h2><p>Most of our customers are clothing brands. They don&rsquo;t usually make the clothes themselves, and instead order them from so-called tier 1 suppliers. Several tier 1 suppliers might supply the same SKU. For instance, a brand might order 400 units of a t-shirt from supplier A and 600 units from supplier B. Likewise, tier 1 suppliers might get their materials from several tier 2 suppliers.</p><p><img src=/img/blog/hard-data-integration-problems-at-carbonfact/multisourcing.svg width=95% style=box-shadow:none></p><p>This is called a <a href=https://en.wikipedia.org/wiki/Multisourcing>multisourced</a> supply chain. Distinguishing each supply chain variation is important to us, because each one leads to a different carbon footprint. For instance, tier 1 supplier A might use a factory in Bangladesh and source its materials from India, while tier 1 supplier B might use a factory in China and source its materials from Vietnam.</p><p>We have access to our customers ERP, so we have a good view of the purchase orders they issue to their tier 1 suppliers. We can therefore create one copy of an SKU for each of its T1 suppliers, and allocate the associated purchase order quantities to it. But we don&rsquo;t have access to the tier 1 suppliers&rsquo; ERP. This means we don&rsquo;t usually know from which tier 2 suppliers the tier 1 suppliers get their materials from. And even when we do, we don&rsquo;t necessarily know what are the quantities involved.</p><p>Sometimes, the bill of materials has one record for each tier 2 supplier of each material. This is a small victory. The problem is that there aren&rsquo;t volumes associated: we don&rsquo;t know how much of each material gets supplied from each tier 2 supplier. Therefore, we can&rsquo;t tell which of the products sent by each tier 1 supplier come from a particular supply chain.</p><p>The workaround is what you would expect: we assume each tier 1 supplier gets its materials from a single tier 2 supplier &ndash; typically the most important one. This is a simplification, but it&rsquo;s the best we can do. The problem is that this assumption is not always true. For instance, a tier 1 supplier might source 80% of its materials from tier 2 supplier A and 20% from tier 2 supplier B.</p><p>What I dislike most with these (necessary) workarounds is that nobody questions them once they are in place. They become the truth. Somebody at some point might point out the simplification, but it&rsquo;s too late: the data has been integrated, the reports have been generated, and the customer has made decisions based on them. Nobody asks questions, especially if the figures make you look good.</p><h2 id=it-migrations-arent-retroactive>IT migrations aren&rsquo;t retroactive</h2><p>Our customers&rsquo; IT systems were set up at a time when environmental impacts weren&rsquo;t top of mind. Their systems and the data that is kept track in them are not sufficient to get actionable environmental measurements. Many of our customers are thus migrating parts of their IT landscape to support these new needs. For instance, they might be implementing a new PLM that has a field for the dyeing process of each material.</p><p>The problem with IT migrations is that they are not retroactive. Existing data is not migrated to these shiny new systems. Instead, customers draw a line in the sand and start using the new system from a certain date. This means that we have to deal with data from two systems: the old one and the new one. The customer now counts as two customers in terms of complexity, but they&rsquo;re only paying for one subscription!</p><p>This happens regularly when we meet with customers for the first time. Let&rsquo;s say we&rsquo;re doing their carbon accounting for 2024. They also want us to their carbon accounting for 2023, in order to compare the two years. We agree, but then we learn that they kicked off their new PLM in 2024. This means that we have to deal with two different PLMs, and we have to make sure that the data from the old PLM is comparable to the new PLM. This isn&rsquo;t usually the case, because the new PLM has more fields and is more detailed.</p><p><img src=/img/blog/hard-data-integration-problems-at-carbonfact/retroactive.svg width=95% style=box-shadow:none></p><p>I find this problem particularly hard to deal with from a human perspective. The people who sign the contract on our side and that of the customer are not the people who actually do the work. The people signing the contract don&rsquo;t have in mind that integrating multiple systems is a necessity, and that each integration essentially involves a separate data pipeline. This can cause friction when the people doing the work realize they have double (or triple!) the work they initially thought.</p><h2 id=information-isnt-correct-and-nobody-has-ownership>Information isn&rsquo;t correct, and nobody has ownership</h2><p>Our points of contact at our customers are usually part of the company&rsquo;s sustainability team. They don&rsquo;t necessarily master the nuances of their IT system. And they don&rsquo;t necessarily someone from their IT team to provide guidance. It&rsquo;s often the case that our point of contact assumes information is available in the system, when in fact it isn&rsquo;t.</p><p>We recently worked with a customer who told us 70% of their fabrics were recycled, which is quite high. However, when we integrated their data and delivered them with a dashboard, they complained that the &ldquo;% recycled&rdquo; KPI was at 0%. After some digging, we (and they) realized that the drop-down in their PLM didn&rsquo;t have recycled as an option. The people entering the data in the PLM (who are not part of the sustainability team) could only specify what kind of material it was (cotton, polyester, etc.), but not whether it was recycled or not. The craziest part of this story is that the sustainability team had been in place for 3 years, and nobody had noticed this!</p><p>I often notice a disconnect between the goals the sustainability team wants to achieve, and what their IT system is capable of. Recently, a customer told us they wanted to highlight that some of their jackets used an innovative water-repellent coating process. The problem of course is that their PLM doesn&rsquo;t have a field for this. The sustainability team was quite disappointed when we told them we couldn&rsquo;t do anything about it. They then asked us if they could compile a manual list of the jackets where this process was used. The problem is that this list would be out of sync with the PLM, would have to be maintained manually, and would require some more adhoc code.</p><p><img src=/img/blog/hard-data-integration-problems-at-carbonfact/misalignment.svg width=95% style=box-shadow:none></p><p>A lot of this comes down to a misalignment of interests and a lack of ownership. Many of our customers are large companies with many departments. The sustainability team is often a small team with a big mission. They don&rsquo;t have the power to change the IT system, and they don&rsquo;t have the power to force other departments to use the system correctly. They&rsquo;re in a tough spot. On top of this, a lot of their IT systems are deployed and managed by expensive consultants. It&rsquo;s <a href="https://news.ycombinator.com/item?id=42010249">data hell</a>.</p></div><script type=text/javascript>var s=document.createElement("script");s.setAttribute("src","https://utteranc.es/client.js"),s.setAttribute("repo","MaxHalford/maxhalford.github.io"),s.setAttribute("issue-term","pathname"),s.setAttribute("crossorigin","anonymous"),s.setAttribute("async",null),s.setAttribute("theme","github-light"),document.body.appendChild(s)</script><div style=display:flex;flex-direction:row;justify-content:center;align-items:center;gap:20px;margin-bottom:30px><div class=do-the-thing><div class=elevator><svg class="sweet-svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 100 100" enable-background="new 0 0 100 100" height="100" width="100"><path d="M70 47.5H30c-1.4.0-2.5 1.1-2.5 2.5v40c0 1.4 1.1 2.5 2.5 2.5h40c1.4.0 2.5-1.1 2.5-2.5V50C72.5 48.6 71.4 47.5 70 47.5zm-22.5 40h-5v-25h5v25zm10 0h-5v-25h5v25zm10 0h-5V60c0-1.4-1.1-2.5-2.5-2.5H40c-1.4.0-2.5 1.1-2.5 2.5v27.5h-5v-35h35v35z"/><path d="M50 42.5c1.4.0 2.5-1.1 2.5-2.5V16l5.7 5.7c.5.5 1.1.7 1.8.7s1.3-.2 1.8-.7c1-1 1-2.6.0-3.5l-10-10c-1-1-2.6-1-3.5.0l-10 10c-1 1-1 2.6.0 3.5 1 1 2.6 1 3.5.0l5.7-5.7v24c0 1.4 1.1 2.5 2.5 2.5z"/></svg>
Back to the top</div></div><div class=subscribe><a href=http://eepurl.com/iRBqMg>Subscribe</a></div></div><script src=https://cdnjs.cloudflare.com/ajax/libs/elevator.js/1.0.1/elevator.min.js></script><script>var elementButton=document.querySelector(".elevator"),elevator=new Elevator({element:elementButton,mainAudio:"/music/elevator.mp3",endAudio:"/music/ding.mp3"})</script><style>.down-arrow{font-size:120px;margin-top:90px;margin-bottom:90px;text-shadow:0 -20px #0c1f31,0 0 #c33329;color:transparent;-webkit-transform:scaleY(.8);-moz-transform:scaleY(.8);transform:scaleY(.8)}.elevator{text-align:center;cursor:pointer;width:140px;margin:auto}.elevator:hover{opacity:.7}.elevator svg{width:40px;height:40px;display:block;margin:auto;margin-bottom:5px}</style><div class=related-content><h3 style=margin-top:10px!important;margin-bottom:10px!important>Related posts</h3><ul style=margin-top:0><li><a href=/blog/funnel-decomposition/>Decomposing funnel metrics</a></li><li><a href="https://www.youtube.com/watch?v=vQGdzKkyPP0">Predire la disponibilitÃ© des Velib' @ Toulouse Data Science Meetup</a></li><li><a href=/blog/kpi-evolution-decomposition/>Answering "Why did the KPI change?" using decomposition</a></li></ul></div></div></div></article></body></html>